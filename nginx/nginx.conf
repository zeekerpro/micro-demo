#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    keepalive_timeout  65;

		# base app
		server {
				listen       3000;
				server_name  localhost;

				location / {
						add_header Access-Control-Allow-Origin *;
						add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
						add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
						if ($request_method = 'OPTIONS') {
								return 204;
						}

						# root   html;
						root  /Users/zeeker/Public/myspace/federation/micro-demo/base/dist/;
						index  index.html index.htm;
						try_files $uri $uri/ /index.html;
				}

				error_page   500 502 503 504  /50x.html;
				location = /50x.html {
						root   html;
				}
		}


		# app1
		server {
			listen       3001;
			server_name  localhost;

			location / {
				add_header Access-Control-Allow-Origin *;
				add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
				add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
				if ($request_method = 'OPTIONS') {
						return 204;
				}
				# root   html;
				root  /Users/zeeker/Public/myspace/federation/micro-demo/sites/app1/dist/;
				# root  /Users/zeeker/Public/myspace/federation/;
				index  index.html index.htm;
				try_files $uri $uri/ /index.html;
			}

			error_page   500 502 503 504  /50x.html;
			location = /50x.html {
				root   html;
			}
		}


		# app2
		server {
			listen       3002;
			server_name  localhost;

			location / {
				add_header Access-Control-Allow-Origin *;
				add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
				add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';
				if ($request_method = 'OPTIONS') {
						return 204;
				}
				# root   html;
				root  /Users/zeeker/Public/myspace/federation/micro-demo/sites/app2/dist/;
				index  index.html index.htm;
				try_files $uri $uri/ /index.html;
			}

			error_page   500 502 503 504  /50x.html;
			location = /50x.html {
					root   html;
			}
		}

}
